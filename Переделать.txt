Система сдвига гемов хуйня.
Нужно находить нулевой гем и менять его не с тем, который находится над текущим, а на ближайший ненулевой сверху, либо не менять, если достигнута граница поля